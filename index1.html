<!DOCTYPE html>
<html>
<head>
    <title>BKC当日シフト(試作品)</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h2>BKC当日シフト(試作品)</h2>
        </div>
        <div class="chat-body">
            <div class="chat-messages" id="chat-messages">
                <div class="assistant-message">
                    <p>Assistant: 名前を入力してください。</p>
                </div>
            </div>
            <div class="user-input">
                <input type="text" id="name-input" placeholder="名前を入力してください">
                <button onclick="searchName()">検索</button>
            </div>
        </div>
    </div>
</body>
</html>

body {
    background-color: #f2f2f2;
    font-family: Arial, sans-serif;
}

.chat-container {
    background-color: #fff;
    max-width: 500px;
    margin: 20px auto;
    border-radius: 8px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
}

.chat-header {
    padding: 20px;
    background-color: #4caf50;
    color: #fff;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
}

.chat-body {
    padding: 20px;
}

.chat-messages {
    margin-bottom: 10px;
}

.assistant-message {
    background-color: #efefef;
    padding: 10px;
    border-radius: 4px;
    margin-bottom: 10px;
}

.user-input {
    display: flex;
    align-items: center;
}

.user-input input {
    flex: 1;
    padding: 8px;
    border-radius: 4px;
    border: 1px solid #ccc;
    margin-right: 10px;
}

.user-input button {
    padding: 8px 16px;
    background-color: #4caf50;
    border: none;
    color: #fff;
    border-radius: 4px;
    cursor: pointer;
}

.user-input button:hover {
    background-color: #3e9041;
}


// CSVファイル読み込み
function csvToArray(path) {
  var csvData = new Array();
  var data = new XMLHttpRequest();  
  data.open("GET", path, false);
  data.send(null);
  var LF = String.fromCharCode(10);
  var CR = String.fromCharCode(13);
  var lines = data.responseText.replace(/\n/g,'').split(CR);
  for (var i = 0; i < lines.length;++i) {
    var cells = lines[i].split(",");
    if( cells.length != 1 ) {
      csvData.push(cells);
    }
  }
  return csvData;
}

// 名前を検索し、結果を表示する関数
function searchName() {
    const nameInput = document.getElementById('name-input');
    const name = nameInput.value;

    if (name.trim() === '') {
        return; // 名前が空の場合は処理しない
    }

    const data = csvToArray('https://docs.google.com/spreadsheets/d/e/2PACX-1vRd6SSkeoF4Q7GpqTp_5l9vg5_3fBAcmaPW55qq2Sg-VuVznkRXusKidnTxmbVGoHIKYuH5RHB9HTkN/pub?gid=213972052&single=true&output=csv');

  let matchingRow = -1; // 該当する行のインデックス（見つからなかった場合は-1）
  let matchingColumn = -1; // 該当する列のインデックス（見つからなかった場合は-1）

// 名前を検索
for (let i = 0; i < data.length; i++) {
  const row = data[i];
  for (let j = 0; j < row.length; j++) {
    if (row[j].includes(name)) {
      matchingRow = i;
      matchingColumn = j;
      break;
    }
  }
  if (matchingRow !== -1) {
    break;
  }
}

const chatMessages = document.getElementById('chat-messages');
const userMessage = document.createElement('div');
userMessage.classList.add('user-message');
userMessage.innerHTML = `<p>User: ${name}</p>`;
chatMessages.appendChild(userMessage);

if (matchingRow !== -1) {
  const matchingValues = data[matchingRow].slice(1); // 該当する行の2列目以降の値を取得

  const assistantMessage = document.createElement('div');
  assistantMessage.classList.add('assistant-message');

  let messageHTML = `<p>Assistant: ${name}さんのシフトを表示します。</p>`;

  for (let i = 0; i < matchingValues.length; i++) {
    const hour = Math.floor(i / 6) + 5; // 時間（5から始まる）
    const minute = (i % 6) * 10; // 分（0, 10, 20, 30, 40, 50）
    const hourString = hour.toString().padStart(2, '0'); // 時間を2桁にする
    const minuteString = minute.toString().padStart(2, '0'); // 分を2桁にする
    const timeString = `${hourString}:${minuteString}`;

    const value = matchingValues[i];
    messageHTML += `<p>${timeString} ${value}</p>`;
  }

  assistantMessage.innerHTML = messageHTML;
  chatMessages.appendChild(assistantMessage);
} else {
  const assistantMessage = document.createElement('div');
  assistantMessage.classList.add('assistant-message');
  assistantMessage.innerHTML = `<p>Assistant: 該当する名前は見つかりませんでした。</p>`;
  chatMessages.appendChild(assistantMessage);
}

nameInput.value = '';
}
// Enterキーのイベントハンドラを追加
document.getElementById('name-input').addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
        event.preventDefault(); // Enterキーのデフォルトの挙動を無効化
        searchName(); // 名前の検索を実行
    }
});

で名前入力欄を固定し、出力をスクロールできるようにしてください。